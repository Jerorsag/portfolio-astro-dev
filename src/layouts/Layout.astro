---
import { getGlobalData } from '../services/global';
import Banner from '../components/Banner.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import "../styles/global.css";

interface Props {
  title?: string;
  description?: string;
}

const { title, description } = Astro.props;

// Obtener datos del global layout
let globalData;
try {
  globalData = await getGlobalData();
  console.log('üéØ Global data loaded successfully');
} catch (error) {
  console.error('‚ùå Failed to load global data:', error);
  // Podr√≠amos mostrar un fallback o lanzar el error
  throw error;
}

const pageTitle = title || globalData.attributes.title;
const pageDescription = description || globalData.attributes.description;
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{pageTitle}</title>
  <meta name="description" content={pageDescription}>

  <!-- Favicon -->
  <link rel="icon" href="/jr.jpg" />

  <!-- Google tag (gtag.js) -->
  <script type="text/partytown" async src="https://www.googletagmanager.com/gtag/js?id=G-1PPT8MTC4Q"></script>
  <script type="text/partytown">
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-1PPT8MTC4Q');
  </script>
</head>
<body class="min-h-screen flex flex-col">
  <!-- Banner -->
  <Banner banner={globalData.attributes.banner} />
  
  <!-- Header -->
  <Header header={globalData.attributes.header} />
  
  <!-- Main Content -->
  <main class="flex-1">
    <slot />
  </main>
  
  <!-- Footer -->
  <Footer footer={globalData.attributes.footer} />
</body>
</html>